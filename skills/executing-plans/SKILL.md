---
name: executing-plans
description: 當你有一個需要在單獨會話中執行並帶有審查檢查點的書面實作計劃時使用
---

# 執行計劃

## 概述

載入計劃，批判性審查，分批執行任務，在批次之間報告以供審查。

**核心原則：** 分批執行，並設定檢查點供架構師審查。

**開始時宣布：** "我正在使用 executing-plans 技能來實作這個計劃。"

## 流程

### 步驟 1：載入並審查計劃

#### 1.1 格式驗證（必須通過）

計劃檔案**必須**符合 writing-plans 格式，檢查以下必要元素：

| 必要元素 | 驗證方式 |
|----------|----------|
| 標題區塊 | 有 `**目標：**`、`**架構：**`、`**技術棧：**` |
| 任務結構 | 有 `### 任務 N：[名稱] 🟢/🟡/🔴` 格式 |
| 檔案清單 | 每個任務有 `**檔案：**` 區塊 |
| 步驟明細 | 每個任務有 `**步驟 N：**` 格式 |
| 風險標註 | 每個任務有 🟢/🟡/🔴 標記 |
| 變更摘要 | 結尾有 `## 變更摘要` 區塊 |

**如果格式不符：**
- 停止執行
- 告知使用者：「此計劃不符合 writing-plans 格式，缺少：[列出缺少元素]」
- 建議：「請使用 writing-plans 技能重新產生計劃，或補齊缺少的元素。」

#### 1.2 內容審查

格式驗證通過後：
1. 閱讀計劃檔案
2. 批判性審查 - 識別對計劃的任何問題或疑慮
3. 如果有疑慮：在開始前向你的人類夥伴提出
4. 如果沒有疑慮：建立 TodoWrite 並繼續

### 步驟 2：執行批次
**預設：前 3 個任務**

對於每個任務：
1. 標記為進行中
2. 完全按照每個步驟執行（計劃有小步驟）
3. 按指定執行驗證
4. 標記為已完成

### 風險等級執行控管

**🔴 High 風險任務：**
1. 暫停並向使用者單獨確認：「任務 N 是高風險變更，涉及 [具體影響]。確認執行？」
2. 確認備份/回滾指令已就緒
3. 獲得明確同意後才執行
4. 執行後立即驗證，報告結果並等待確認再繼續

**🟡 Medium 風險任務：**
1. 提醒：「執行任務 N（Medium 風險）：[簡述影響]」
2. 確認相關測試存在
3. 執行後在批次報告中特別標註結果

**🟢 Low 風險任務：**
- 可直接執行，無需額外確認
- 完成後納入批次報告

### 步驟 3：報告
批次完成時：
- 顯示已實作的內容
- 顯示驗證輸出
- 特別標註 🟡/🔴 任務的執行結果
- 說："準備好接受反饋。"

### 步驟 4：繼續
根據反饋：
- 如果需要，套用變更
- 執行下一批次
- 重複直到完成

### 步驟 5：完成開發

所有任務完成並驗證後：

1. **檢查分支狀態**：
   ```bash
   git branch --show-current
   ```

2. **根據分支決定下一步**：

   **如果在功能分支（非 main/master）：**
   - 宣布："我正在使用 finishing-a-development-branch 技能來完成這項工作。"
   - **必要子技能：** 使用 hi-skills:finishing-a-development-branch
   - 遵循該技能以驗證測試、呈現選項、執行選擇

   **如果在主分支（main/master）：**
   - 報告完成摘要：已完成的任務、提交記錄
   - 詢問使用者：「變更已在本地 main 分支。要推送到遠端嗎？」
   - 根據使用者選擇執行 `git push` 或保持現狀

## 決策優先順序

當執行過程中遇到需要判斷的情況，依此順序決策：

1. **資料安全與隔離** - 絕不為了方便而暴露資料
2. **權限正確性** - 最小權限原則，不過度開放
3. **不破壞既有行為** - 向後相容優先
4. **可測試性** - 變更必須能被驗證
5. **程式碼可讀性** - 清晰優於簡潔

**Anti-Goals（禁止事項）：**
- ❌ 為修錯而開放整個權限範圍
- ❌ 合併不相關的邏輯變更
- ❌ 為簡化而放寬安全條件
- ❌ 跳過測試驗證步驟

## 何時停止並尋求幫助

**在以下情況立即停止執行：**
- 在批次中遇到阻礙（缺少依賴項、測試失敗、指令不清楚）
- 計劃有關鍵缺口導致無法開始
- 你不理解某個指令
- 驗證重複失敗

**寧可詢問澄清而不是猜測。**

## 何時重新訪問早期步驟

**在以下情況返回審查（步驟 1）：**
- 夥伴根據你的反饋更新了計劃
- 基本方法需要重新思考

**不要強行通過阻礙** - 停下來詢問。

## 記住
- 首先批判性審查計劃
- 完全按照計劃步驟執行
- 不要跳過驗證
- 當計劃說要時引用技能
- 批次之間：只報告並等待
- 被阻止時停止，不要猜測
